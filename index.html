<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Meditation Timer</title>
    <meta name="description" content="A peaceful meditation timer PWA with 31-minute countdown, spiritual dark theme, and calming atmosphere for focused meditation sessions.">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a0b2e">
    <meta name="application-name" content="Meditation Timer">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Meditation Timer">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
      
      :root {
        --cosmic-deep: hsl(215, 50%, 8%);
        --cosmic-purple: hsl(264, 56%, 11%);
        --cosmic-indigo: hsl(252, 44%, 25%);
        --ethereal-cyan: hsl(174, 100%, 70%);
        --soft-gray: hsl(210, 20%, 60%);
        --muted-white: hsla(0, 0%, 100%, 0.05);
      }
      
      body {
        font-family: 'Inter', sans-serif;
        overflow-x: hidden;
      }
      
      .spiritual-bg {
        background: linear-gradient(135deg, var(--cosmic-deep) 0%, var(--cosmic-purple) 35%, var(--cosmic-indigo) 70%, hsl(240, 44%, 35%) 100%);
        min-height: 100vh;
        position: relative;
      }
      
      .spiritual-bg::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
          radial-gradient(circle at 20% 80%, hsla(264, 56%, 20%, 0.3) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, hsla(174, 100%, 70%, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 40% 40%, hsla(252, 44%, 25%, 0.2) 0%, transparent 50%);
        pointer-events: none;
      }
      
      @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-10px) rotate(2deg); }
      }
      
      @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 0 20px hsla(174, 100%, 70%, 0.3); }
        50% { box-shadow: 0 0 30px hsla(174, 100%, 70%, 0.5); }
      }
      
      @keyframes twinkle {
        0%, 100% { opacity: 0.3; transform: scale(0.8); }
        50% { opacity: 1; transform: scale(1.2); }
      }
      
      .star {
        position: absolute;
        width: 2px;
        height: 2px;
        background: var(--ethereal-cyan);
        border-radius: 50%;
        animation: twinkle 3s ease-in-out infinite;
        pointer-events: none;
      }
      
      .star:nth-child(odd) {
        animation-duration: 4s;
      }
      
      .star:nth-child(3n) {
        animation-duration: 2.5s;
      }
      
      .animate-float {
        animation: float 6s ease-in-out infinite;
      }
    </style>
  </head>
  <body class="spiritual-bg min-h-screen flex flex-col items-center justify-center text-white">
    <!-- Timer App Content -->
    <div class="text-center max-w-md mx-auto p-8">
      <!-- Timer Display -->
      <div class="mb-8">
        <div id="timer-display" class="font-mono text-6xl md:text-8xl font-bold mb-4">
          <span id="hours" class="text-xs opacity-40">0</span>:<span id="minutes" class="text-cyan-300">31</span>:<span id="seconds" class="text-gray-400 text-4xl md:text-6xl">00</span>
        </div>
        <div id="timer-state" class="text-lg text-gray-300 mb-6">Ready to begin</div>
      </div>

      <!-- Timer Controls -->
      <div class="flex gap-4 justify-center mb-8">
        <button id="toggle-btn" class="bg-cyan-500 hover:bg-cyan-400 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
          Start
        </button>
        <button id="reset-btn" class="bg-gray-600 hover:bg-gray-500 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
          Reset
        </button>
      </div>

      <!-- Quick Settings -->
      <div class="mb-6">
        <div class="text-sm text-gray-400 mb-3">Quick Settings</div>
        <div class="flex flex-wrap gap-2 justify-center">
          <button class="preset-btn bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors" data-minutes="5">5m</button>
          <button class="preset-btn bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors" data-minutes="10">10m</button>
          <button class="preset-btn bg-cyan-600 hover:bg-cyan-500 text-white px-4 py-2 rounded text-sm transition-colors" data-minutes="31">31m</button>
          <button class="preset-btn bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors" data-minutes="45">45m</button>
          <button class="preset-btn bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors" data-minutes="60">60m</button>
        </div>
      </div>

      <!-- PWA Install -->
      <div id="pwa-install" class="hidden">
        <button id="install-btn" class="bg-purple-600 hover:bg-purple-500 text-white px-6 py-2 rounded text-sm transition-colors">
          Install App
        </button>
      </div>
    </div>

    <!-- Floating Stars -->
    <div class="star" style="top: 20%; left: 15%; animation-delay: 0s;"></div>
    <div class="star" style="top: 30%; left: 85%; animation-delay: 1s;"></div>
    <div class="star" style="top: 60%; left: 25%; animation-delay: 2s;"></div>
    <div class="star" style="top: 80%; left: 75%; animation-delay: 1.5s;"></div>
    <div class="star" style="top: 15%; left: 65%; animation-delay: 3s;"></div>
    <div class="star" style="top: 70%; left: 10%; animation-delay: 2.5s;"></div>

    <script>
      // Meditation timer functionality
      let timeLeft = 31 * 60; // 31 minutes in seconds
      let totalTime = 31 * 60;
      let isRunning = false;
      let interval = null;
      
      // Get DOM elements
      const hoursEl = document.getElementById('hours');
      const minutesEl = document.getElementById('minutes');
      const secondsEl = document.getElementById('seconds');
      const stateEl = document.getElementById('timer-state');
      const toggleBtn = document.getElementById('toggle-btn');
      const resetBtn = document.getElementById('reset-btn');
      const presetBtns = document.querySelectorAll('.preset-btn');
      
      function updateDisplay() {
        const hours = Math.floor(timeLeft / 3600);
        const minutes = Math.floor((timeLeft % 3600) / 60);
        const seconds = timeLeft % 60;
        
        hoursEl.textContent = hours;
        minutesEl.textContent = minutes;
        secondsEl.textContent = seconds.toString().padStart(2, '0');
      }
      
      function startTimer() {
        if (interval) return;
        isRunning = true;
        toggleBtn.textContent = 'Pause';
        stateEl.textContent = 'Meditating...';
        
        interval = setInterval(() => {
          timeLeft--;
          updateDisplay();
          
          if (timeLeft <= 0) {
            stopTimer();
            stateEl.textContent = 'Meditation Complete!';
            // Play completion sound (basic beep)
            try {
              const audioContext = new (window.AudioContext || window.webkitAudioContext)();
              const oscillator = audioContext.createOscillator();
              const gainNode = audioContext.createGain();
              
              oscillator.connect(gainNode);
              gainNode.connect(audioContext.destination);
              
              oscillator.frequency.value = 528; // Meditation frequency
              gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
              gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
              
              oscillator.start(audioContext.currentTime);
              oscillator.stop(audioContext.currentTime + 1);
            } catch (e) {
              console.log('Audio not available');
            }
          }
        }, 1000);
      }
      
      function pauseTimer() {
        if (!interval) return;
        clearInterval(interval);
        interval = null;
        isRunning = false;
        toggleBtn.textContent = 'Start';
        stateEl.textContent = 'Paused';
      }
      
      function stopTimer() {
        if (interval) {
          clearInterval(interval);
          interval = null;
        }
        isRunning = false;
        toggleBtn.textContent = 'Start';
      }
      
      function resetTimer() {
        stopTimer();
        timeLeft = totalTime;
        updateDisplay();
        stateEl.textContent = 'Ready to begin';
      }
      
      function setTimer(minutes) {
        stopTimer();
        totalTime = minutes * 60;
        timeLeft = totalTime;
        updateDisplay();
        stateEl.textContent = 'Ready to begin';
        
        // Update preset button styles
        presetBtns.forEach(btn => {
          btn.classList.remove('bg-cyan-600', 'hover:bg-cyan-500');
          btn.classList.add('bg-gray-700', 'hover:bg-gray-600');
        });
        
        const activeBtn = document.querySelector(`[data-minutes="${minutes}"]`);
        if (activeBtn) {
          activeBtn.classList.remove('bg-gray-700', 'hover:bg-gray-600');
          activeBtn.classList.add('bg-cyan-600', 'hover:bg-cyan-500');
        }
      }
      
      // Event listeners
      toggleBtn.addEventListener('click', () => {
        if (isRunning) {
          pauseTimer();
        } else {
          startTimer();
        }
      });
      
      resetBtn.addEventListener('click', resetTimer);
      
      presetBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const minutes = parseInt(btn.dataset.minutes);
          setTimer(minutes);
        });
      });
      
      // Initialize display
      updateDisplay();
      
      // PWA functionality
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js')
          .then(() => console.log('Service Worker registered'))
          .catch((error) => console.log('Service Worker registration failed:', error));
      }
    </script>
  </body>
</html>